/*! jQuery Carousel Plugin by Thomas Jaggi (2012) - http://github.com/backflip/jquery-carousel/ */(function(e,t,n,r){"use strict";var i="carousel",s={animation:{duration:300,step:1},behavior:{horizontal:!0,circular:!1,autoplay:0,keyboardNav:!0},elements:{prevNext:!0,handles:!0,counter:!0},events:{start:!1,stop:!1},initialSlide:0,text:{next:"Next Image",prev:"Previous Image",counter:"%current% / %total%",handle:"%index%"},touch:{enabled:!0,thresholds:{speed:.4,distance:.3}},visibleSlides:1},o={getTransitionProperty:function(){var e=t.body||t.documentElement,n="transition",r,i=["Moz","ms","O","Webkit"],s=e.style;if(typeof s[n]=="string")return n;n=n.charAt(0).toUpperCase()+n.substr(1);for(var o=0;o<i.length;o++){r=i[o]+n;if(typeof s[r]=="string")return r}return!1},getTransitionEndEvent:function(){var e=o.getTransitionProperty(),t={transition:"transitionEnd",MozTransition:"transitionend",msTransition:"msTransitionEnd",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd"};return t[e]||!1},getNamespacedEvents:function(e){var t=e.split(" ");for(var n=0;n<t.length;n++)t[n]=t[n]+"."+i;return t.join(" ")},enableButton:function(e){e.removeClass("state-disabled").removeAttr("aria-disabled").attr("tabindex",0)},disableButton:function(e){e.addClass("state-disabled").attr("aria-disabled",!0).attr("tabindex",-1)}},u={touch:"ontouchstart"in e,transition:o.getTransitionProperty()},a=o.getNamespacedEvents(u.touch?"touchstart":"click keydown"),f=!1,l=0,c=function(e,t){this.$dom={slider:n(e),slides:n(e).children(),container:n('<div class="'+i+'-container"  />'),frame:n('<div class="'+i+'-frame" />'),navContainer:n('<div class="'+i+'-nav" aria-hidden="true" />'),counter:n('<div class="'+i+'-counter" aria-hidden="true" />'),prev:n('<span class="'+i+'-prev" role="button" tabindex="2" />'),next:n('<span class="'+i+'-next" role="button" tabindex="1" />'),handlesContainer:n('<div class="'+i+'-handles" aria-hidden="true" />'),handles:null,handle:n('<span class="'+i+'-handle" role="button" tabindex="0" />')};this.props={current:0,total:0,visible:0};this.state={enabled:!1,animating:!1};this.settings=n.extend(!0,{},t,this.$dom.slider.data(i+"-options"))};c.prototype={init:function(){var t=this,r=this.$dom,u=null,a;if(this.$dom.slider.data(i)||this.$dom.slider.length===0)return this;this.index=l++;this.settings=n.extend(!0,{},s,this.settings);a=this._getStyles(r.slider);r.slider.data(i+"-css",a);r.slides.each(function(){var e=n(this),r=t._getStyles(e);e.data(i+"-css",r)});r.container.insertBefore(r.slider);r.frame.appendTo(r.container).append(r.slider.addClass(i+"-slider"));if(this.settings.elements.prevNext){r.prev.appendTo(r.navContainer).text(this.settings.text.prev);r.next.appendTo(r.navContainer).text(this.settings.text.next);r.navContainer.appendTo(r.container);r.nav=r.prev.add(r.next)}this.settings.elements.counter&&r.counter.appendTo(r.container);this.settings.elements.handles&&r.handlesContainer.appendTo(r.container);r.slides.addClass(i+"-slide");this.settings.behavior.circular&&r.slides.each(function(e){n(this).data(i+"-index",e)});this.settings.behavior.horizontal||r.container.addClass(i+"-vertical");this.update();n(e).on(o.getNamespacedEvents("resize")+this.index,n.proxy(function(){u&&clearTimeout(u);u=setTimeout(n.proxy(function(){this.resize()},this),100)},this));r.slider.data(i,this);return this},update:function(e){var t=this;n.extend(!0,this.settings,e);this.$dom.slides=this.$dom.slides.parent().children();this.props.total=this.$dom.slides.length;this.props.current=this.settings.initialSlide;this.props.visible=this._getVisibleSlides();if(this.settings.elements.handles){this.$dom.handlesContainer.html(this._getHandles());this.$dom.handles=this.$dom.handlesContainer.children()}this.resize();this.disable();this.enable()},resize:function(){var e=this.$dom.frame.width(),t,n=this.settings.behavior.horizontal?e/this.props.visible:e,r,i=this.settings.behavior.horizontal?this.props.total*n:n;this.$dom.slides.width(n);this.$dom.slider.width(i).height("auto");r=this._getHighestSlide();this.$dom.slides.css("min-height",r);t=this.settings.behavior.horizontal?r:this.props.visible*r;this.$dom.frame.height(t);this.goTo(this.props.current,!0)},enable:function(){var e=this;if(this.state.enabled||this.props.visible>this.props.total)return;this.settings.elements.prevNext&&this.$dom.nav.on(a,function(t){var r=n(this),i=r.hasClass("state-disabled"),s,o,u;if(i)return;s=r.is(e.$dom.next)?1:-1;o=s*e.settings.animation.step+e.props.current;u=function(){e.goTo(o)};e._handleButtonEvents(t,r,u)});this.settings.elements.handles&&this.$dom.handles.on(a,function(t){var r=n(this),i=r.index(),s=e._getSlideIndex(i),o=function(){e.goTo(s)};e._handleButtonEvents(t,r,o)});this.settings.touch.enabled&&u.touch&&this._touchEnable();this.settings.behavior.keyboardNav&&this.$dom.container.on(o.getNamespacedEvents("keydown"),n.proxy(function(t){var r=n(t.target),i=r.get(0).nodeName.toLowerCase(),s=n.inArray(i,["input","textarea"])!==-1,o=!1;if(!(s||t.metaKey||t.ctrlKey)){var u=t.keyCode||t.which,a,f;if(n.inArray(u,[37,80])!==-1){this.prev();this.$dom.prev.focus();o=!0}else if(n.inArray(u,[39,78])!==-1){this.next();this.$dom.next.focus();o=!0}else if(47<u&&u<58){a=u-49;f=e._getSlideIndex(a);this.goTo(f);this.settings.elements.handles&&this.$dom.handles.eq(a).focus();o=!0}}if(o){this._autoplayDisable();t.preventDefault()}},this));this.settings.behavior.autoplay&&(this.autoplay=setInterval(function(){e.next()},this.settings.behavior.autoplay));this.state.enabled=!0;this._updateNav()},disable:function(e){if(!this.state.enabled)return;this.settings.elements.prevNext&&this.$dom.nav.off(a);this.settings.elements.handles&&this.$dom.handles.off(a);this.settings.touch.enabled&&u.touch&&this._touchDisable();this.settings.behavior.keyboardNav&&this.$dom.container.off(o.getNamespacedEvents("keydown"));this.settings.behavior.autoplay&&this._autoplayDisable();this.state.enabled=!1;this._updateNav()},goTo:function(e,t){var n=this,r=this._getValidatedTarget(e),i=this._getTargetPosition(r),s=t?0:this.settings.animation.duration,a=function(){n.settings.events.stop&&n.settings.events.stop(r);n.state.animating=!1},f,l,c,h,p;if(!t){this.state.animating=!0;this.settings.events.start&&this.settings.events.start(r);if(!u.transition)this.$dom.slider.animate(i,s,function(){a()});else{f=u.transition;l=this.settings.behavior.horizontal?"left":"top";c=o.getNamespacedEvents(o.getTransitionEndEvent());p=this.$dom.slider.css(f);h=l+" "+s/1e3+"s ease-in-out";this.$dom.slider.css(f,h);this.$dom.slider.css(i);this.$dom.slider.on(c,function(){n.$dom.slider.off(c);n.$dom.slider.css(f,p);a()})}}else this.$dom.slider.css(i);this.props.current=r;this._updateNav()},next:function(){this.goTo(this.props.current+this.settings.animation.step)},prev:function(){this.goTo(this.props.current-this.settings.animation.step)},destroy:function(){var t=this.$dom,r=t.slider.data(i+"-css");t.slider.removeClass(i+"-slider").removeData(i).removeData(i+"-css").insertAfter(t.container).css(r);t.slides.removeClass(i+"-slide").removeData(i+"-index").each(function(){var e=n(this),t=e.data(i+"-css");e.css(t)}).removeData(i+"-css");t.container.remove();this.state.enabled=!1;this.props.current=0;n(e).off(o.getNamespacedEvents("resize")+this.index)},_autoplayDisable:function(){clearInterval(this.autoplay);this.autoplay=null},_handleButtonEvents:function(e,t,r){switch(e.type){case"keydown":if(!e.metaKey&&!e.ctrlKey){var s=e.keyCode||e.which;if(n.inArray(s,[13,32])!==-1){r();e.preventDefault()}}break;case"touchstart":f=!1;t.on("touchmove."+i,function(){f=!0});t.on("touchend."+i,function(){t.off("touchmove."+i);t.off("touchend."+i);f||r()});break;default:r()}this.settings.behavior.autoplay&&this._autoplayDisable()},_getHandles:function(){var e=t.createDocumentFragment();for(var r=0;r<this.props.total;r++){var i=this.settings.text.handle.replace("%index%",r+1),s=this.$dom.handle.clone().text(i).get(0);e.appendChild(s)}return n(e)},_getHighestSlide:function(){var e=0;this.$dom.slides.each(function(){var t=n(this).css("min-height",0).height();t>e&&(e=t)});return e},_getSlideIndex:function(e,t){this.settings.behavior.circular&&this.$dom.slides.each(function(){var r=n(this),s=r.index(),o=r.data(i+"-index"),u=t?s:o;if(e===u){e=s;return!1}});return e},_getStyles:function(e){var t=["height","left","min-height","top","width"],n={},r;for(var i=0;i<t.length;i++)n[t[i]]=e.css(t[i]);if(u.transition){r=u.transition.charAt(0).toLowerCase()+u.transition.substr(1);n[r]=e.css(r)}return n},_getTargetPosition:function(e){var t=this.settings.behavior.horizontal?this.$dom.slides.width():this.$dom.slides.height(),n=this.settings.behavior.horizontal?"left":"top",r={};r[n]=-e*t;return r},_getValidatedTarget:function(e){if(!this.settings.behavior.circular)e<0?e=0:e>=this.props.total-this.props.visible&&(e=this.props.total-this.props.visible);else if(e<0){var t=this.props.total+e;if(this._shiftSlides(t,-1))return 0}else if(this.props.total>this.props.visible&&e>this.props.total-this.props.visible){var n=e-1-(this.props.total-this.props.visible);if(this._shiftSlides(n,1))return e-(n+1)}return e},_getVisibleSlides:function(){if(this.settings.visibleSlides>0)return this.settings.visibleSlides;var e=this,t=0,r=this.settings.behavior.horizontal?this.$dom.frame.width():this.$dom.frame.height();this.$dom.slides.each(function(){var r=e.settings.behavior.horizontal?n(this).width():n(this).height();r>t&&(t=r)});return Math.round(r/t)},_shiftSlides:function(e,t){var n=t===-1?":gt("+(e-1)+")":":lt("+(e+1)+")",r=this.$dom.slides.filter(n);if(r.length>0){var i=this.settings.behavior.horizontal?"left":"top",s=this.settings.behavior.horizontal?this.$dom.slides.width():this.$dom.slides.height(),o=this.$dom.slider.position(),u={};u[i]=o[i]+t*r.length*s;t===-1?r.prependTo(this.$dom.slider):r.appendTo(this.$dom.slider);this.$dom.slides=this.$dom.slider.children();this.$dom.slider.css(u);return!0}return!1},_touchEnable:function(){function u(){var n={x:t.end.x-t.start.x,y:t.end.y-t.start.y};e.settings.behavior.horizontal||(n={x:n.y,y:n.x});return n}var e=this,t={start:{x:0,y:0},end:{x:0,y:0}},n={start:0,end:0},r={distance:e.settings.touch.thresholds.distance*e.$dom.frame.width(),speed:e.settings.touch.thresholds.speed*e.$dom.frame.width()},s={top:0,left:0},o={};o["touchstart."+i]=function(r){var i=r.originalEvent.targetTouches[0];t.start.x=i.pageX;t.start.y=i.pageY;s=e.$dom.slider.position();n.start=(new Date).getTime();f=!1};o["touchmove."+i]=function(n){var r=n.originalEvent.targetTouches[0],i=0,o={},a=e.settings.behavior.horizontal?"left":"top",l;t.end.x=r.pageX;t.end.y=r.pageY;i=u();if(Math.abs(i.x)>Math.abs(i.y)){l=e.settings.behavior.horizontal?s.left:s.top;o[a]=l+i.x;e.$dom.slider.css(o);f=!0;n.preventDefault()}};o["touchend."+i]=function(t){if(!f)return;var i=t.originalEvent.targetTouches[0],s=u(),o,a=e.props.current;if(Math.abs(s.x)>Math.abs(s.y)){n.end=(new Date).getTime();o=Math.abs(s.x)/(n.end-n.start)*1e3;if(Math.abs(s.x)>r.distance||o>r.speed){var l=e.settings.behavior.horizontal?e.$dom.slides.width():e.$dom.slides.height(),c=s.x>0?-1:1,h=Math.abs(Math.round(s.x/l));h<1&&o>r.speed&&(h=1);a=e.props.current+c*h}e.goTo(a)}};this.$dom.frame.on(o)},_touchDisable:function(){this.$dom.frame.off(o.getNamespacedEvents("touchstart touchmove touchend"))},_updateNav:function(){if(this.state.enabled){if(this.settings.elements.prevNext){o.enableButton(this.$dom.prev);o.enableButton(this.$dom.next);if(!this.settings.behavior.circular){this.props.current===0?o.disableButton(this.$dom.prev):o.enableButton(this.$dom.prev);this.props.current===this.props.total-this.props.visible?o.disableButton(this.$dom.next):o.enableButton(this.$dom.next)}}if(this.settings.elements.handles){var e=this._getSlideIndex(this.props.current,!0),t=e>0?":gt("+(e-1)+"):lt("+this.props.visible+")":":lt("+(e+this.props.visible)+")";o.enableButton(this.$dom.handles);this.$dom.handles.removeClass("state-current");this.$dom.handles.filter(t).addClass("state-current")}}else{if(this.settings.elements.prevNext){o.disableButton(this.$dom.prev);o.disableButton(this.$dom.next)}this.settings.elements.handles&&o.disableButton(this.$dom.handles)}if(this.settings.elements.counter){var n=this._getSlideIndex(this.props.current,!0)+1,r=n+(this.props.visible-1),i;if(this.props.visible>1){r>this.props.total&&(r=this.props.total);n+="-"+r}i=this.settings.text.counter.replace("%current%",n).replace("%total%",this.props.total);this.$dom.counter.text(i)}}};n.fn[i]=function(e){var t=arguments;return this.each(function(){var r=n(this),s=r.data(i);s?typeof e=="object"?s.update.apply(s,t):s[e].apply(s,Array.prototype.slice.call(t,1)):(new c(this,e)).init()})};e[i.charAt(0).toUpperCase()+i.substr(1)]=c})(window,document,jQuery);